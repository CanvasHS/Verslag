\section{Testresultaten} \label{sec:testresultaten}

\todo{Onderdeel over analyse van geheugengebruik schrijven}
\todo{Performance analyse van JavaScript onderdeel schrijven}

Door het gebruik van voornamelijk twee verschillende programmeertalen zijn de tests voor deze toepassingen ook apart geschreven. Alle tests kunnen gezamenlijk via cabal test aangeroepen worden. Dit vereist wel enige configuratie. Uitgebreide uitleg over het uitvoeren en ontwikkelen van tests is te vinden op de website van Canvas.hs: \url{http://canvashs.github.io/test.html}.

\subsection{JavaScript}
Voor de JavaScript code zijn unit tests ontwikkeld in Jasmine. Met behulp van Blanket.js is de code coverage van de tests gemeten. Hieronder wordt de lijst met testcases weergegeven van de JavaScript code. Alle test cases worden correct uitgevoerd.

\subsubsection{Testcases}
\newcounter{startvaluetest}
\begin{enumerate}[label={T\arabic*}]
	\item Convert colors
	\begin{enumerate}[label={T\arabic{enumi}.\arabic*}]
		\item \label{test:js:convert:rgbajson:rgba} converts rgba json to rgba
		\item \label{test:js:convert:rgbajson:rgba:alphazero} converts rgba json to rgba with zero alpha
		\item \label{test:js:convert:rgbjson:rgba} converts rgb json to rgba
	\end{enumerate}
	\item Parse elements
	\begin{enumerate}[label={T\arabic{enumi}.\arabic*}]
		\item \label{test:js:parse:rect} parses a rectangle
		\item \label{test:js:parse:circle} parses a circle
		\item \label{test:js:parse:container} parses a container
	\end{enumerate}
	\item Draw elements
	\begin{enumerate}[label={T\arabic{enumi}.\arabic*}]
		\item \label{test:js:draw:rect} draws a rectangle
		\item \label{test:js:draw:polygon} draws a polygon
		\item \label{test:js:draw:circle} draws a circle (using rgb)
		\item \label{test:js:draw:circle:alpha} draws a circle with stroke alpha zero
		\item \label{test:js:draw:text} draws text
		\item \label{test:js:draw:container} draws container
		\item \label{test:js:draw:container:clipping} draws container with clipping
	\end{enumerate}
	\setcounter{startvaluetest}{\value{enumi}}
\end{enumerate}

\subsection{Haskell}
Voor de Haskell code zijn unit tests ontwikkeld. De code coverage van de tests is gemeten met hpc waarvoor standaard een commando is meegeleverd in Cabal. Hieronder wordt een overzicht met testcases weergegeven van de Haskell code. Alle test cases worden correct uitgevoerd.


\subsubsection{Testcases}

\input{./Hoofdstukken/resultaten/tests/haskell.tex}

\subsection{Blackbox testing}
Er zijn non-functionele requirements opgesteld in \autoref{hoofdstuk:requirements}. Deze requirements zijn lastig automatisch te testen. Daarom zijn hiervoor blackbox testen uitgevoerd zodat ook deze requirements getest zijn.

\subsubsection{Testcases}
\begin{enumerate}[label={T\arabic*}]
	\setcounter{enumi}{\value{startvaluetest}}
	\item Multiplatform, bij deze test wordt getest of de demoapplicatie werkt op ieder besturingssysteem.
    \begin{enumerate}[label={T\arabic{enumi}.\arabic*}]
    	\item de demoapplicatie kan gedraaid worden in Windows
    	\item de demoapplicatie kan gedraaid worden in Linux
    	\item de demoapplicatie kan gedraaid worden in OS X
    	\item de demoapplicatie kan gedraaid worden in OS X met retina display
    \end{enumerate}
	\item Browser onafhankelijk, bij deze test wordt getest of de demoapplicatie werkt in de laatste versies van iedere browser.
    \begin{enumerate}[label={T\arabic{enumi}.\arabic*}]
    	\item de demoapplicatie kan gedraaid worden in Chrome 32
    	\item de demoapplicatie kan gedraaid worden in Firefox 26
    	\item de demoapplicatie kan gedraaid worden in Internet Explorer 11 \todo{Dit daadwerkelijk testen}
    	\item de demoapplicatie kan gedraaid worden in Safari 7 \todo{Dit daadwerkelijk testen}
    \end{enumerate}
	\item Documentatie, bij deze test wordt gekeken of de documentatie aanwezig is voor de code. \todo{Haddock coverage en jsdoc coverage, hier neerzetten?}
	\item Modulair opgebouwd. \todo{Weet even niet hoe we dit hier neer moeten zetten}
	\item Code coverage \todo{Hier iets over zeggen}
\end{enumerate}


\subsection{Traceability matrix} \label{sec:traceability}
De traceability matrix laat zien of alle requirements getests zijn. Wanneer een requirement niet getest is betekent dit dat de functie niet geimplementeerd is of dat er geen test voor bestaat. Met de traceability matrix kan bijgehouden worden of alle functionaliteit geimplementeerd is.

\begin{figure}
\begin{center}
\resizebox{\linewidth}{!}{\input{./Hoofdstukken/resultaten/tests/traceability_matrix.tex}}
\caption{Traceability matrix, zie \autoref{sec:traceability}}
\label{fig:traceability}
\end{center}
\end{figure}

\subsection{Performance analyse}
Tijdens de ontwikkeling van de library is duidelijk geworden dat de performance van de geschreven programma's niet altijd optimaal is. Met name bij programma's die gebruik maken van \emph{timers} en bij programma's met grote \emph{shape grafen}.\todo{shape graph eerder introduceren}

\todo{uitleggen}

Er waren vermoedens dat de oorzaak gevonden kon worden in het omzetten van \inlinecode{Strings} naar \inlinecode{ByteSrings} en vice versa.

Na het analyseren van de JavaScript performance bleek dat het opnieuw bouwen van de stage vanuit de \emph{shape graph} een grote deuk in de performance oplevert. Het vervolgens tekenen van de nieuwe inhoud van het Canvas duurde relatief minder lang. Bijvoorbeeld in ons testprogramma duurde het opnieuw bouwen van de stage ±6 ms waar het opnieuw teken ±0.5 ms duurde.






