\section{Testresultaten} \label{sec:testresultaten}
Zoals in \autoref{hoofdstuk:testplan} beschreven zijn er verschillende tools en libraries gebruikt voor het automatisch testen van de functionele requirements. Daarnaast is er een aanpak voor het testen van de niet-functionele requirements. In dit hoofdstuk staan de resultaten van de tests voor zowel de functionele als niet-functionele requirements beschreven.

De resultaten van de automatische tests kunnen gecontrolleerd worden door deze zelf uit te voeren. Een uitgebreide uitleg over het uitvoeren en ontwikkelen van tests is te vinden op de website van Canvas.hs: \url{http://canvashs.github.io/test.html}.

\subsection{JavaScript}
Voor de JavaScript-code zijn unit tests ontwikkeld in Jasmine. Met behulp van Blanket.js is de code coverage van de tests gemeten. Hieronder wordt de lijst met testcases weergegeven van de JavaScript-code. Alle test cases worden correct uitgevoerd.

\subsubsection{Testcases}
\newcounter{startvaluetest}
\begin{enumerate}[label={T\arabic*}]
	\item Execute actions
	\begin{enumerate}[label={T\arabic{enumi}.\arabic*}]
		\item \label{test:js:execute:actions:fixedsize} set fixed proportions
		\item \label{test:js:execute:actions:fluidsize} set fluid proportions
		\item \label{test:js:execute:actions:displayfixed} set window display type fixed
		\item \label{test:js:execute:actions:displayfluid} set window display type fluid
		\item \label{test:js:execute:actions:opencontrol} open control window
		\item \label{test:js:execute:actions:closecontrol} close control window
	\end{enumerate}
	\item Parse and run actions
	\begin{enumerate}[label={T\arabic{enumi}.\arabic*}]
		\item \label{test:js:parse:actions:no} parse no actions
		\item \label{test:js:parse:actions:fixedsize} parse fixedsize action
		\item \label{test:js:parse:actions:fluidsize} parse fluidsize action
		\item \label{test:js:parse:actions:fullscreen} parse fullscreen action
	\end{enumerate}
	\item Convert colors
	\begin{enumerate}[label={T\arabic{enumi}.\arabic*}]
		\item \label{test:js:convert:rgbajson:rgba} converts rgba json to rgba
		\item \label{test:js:convert:rgbajson:rgba:alphazero} converts rgba json to rgba with zero alpha
		\item \label{test:js:convert:rgbjson:rgba} converts rgb json to rgba
	\end{enumerate}
	\item Parse elements
	\begin{enumerate}[label={T\arabic{enumi}.\arabic*}]
		\item \label{test:js:parse:rect} parses a rectangle
		\item \label{test:js:parse:circle} parses a circle
		\item \label{test:js:parse:container} parses a container
	\end{enumerate}
	\item Draw elements
	\begin{enumerate}[label={T\arabic{enumi}.\arabic*}]
		\item \label{test:js:draw:rect} draws a rectangle
		\item \label{test:js:draw:polygon} draws a polygon
		\item \label{test:js:draw:circle} draws a circle (using rgb)
		\item \label{test:js:draw:circle:alpha} draws a circle with stroke alpha zero
		\item \label{test:js:draw:text} draws text
		\item \label{test:js:draw:container} draws container
		\item \label{test:js:draw:container:clipping} draws container with clipping
	\end{enumerate}

	\item Mouse events
	\begin{enumerate}[label={T\arabic{enumi}.\arabic*}]
		\item \label{test:js:mouse:no} no event handlers
		\item \label{test:js:mouse:create} creating mouse event handlers
		\item \label{test:js:mouse:drag} creating mousedrag event handler (special case compared to other mouse event handlers)
	\end{enumerate}
	\item Draw elements to test event handling
	\begin{enumerate}[label={T\arabic{enumi}.\arabic*}]
		\item \label{test:js:draw:mousedown} message after mousedown event
		\item \label{test:js:draw:mouseclick} message after mouseclick event
		\item \label{test:js:draw:mouseup} message after mouseup event
		\item \label{test:js:draw:mousedoubleclick} message after mousedoubleclick event
		\item \label{test:js:draw:mouseover} message after mouseover event
		\item \label{test:js:draw:mouseout} message after mouseout event
		\item \label{test:js:draw:mousedrag} message after mousedrag event
		\item \label{test:js:draw:mousedragend} drag end after change of shape
		\item \label{test:js:draw:mousenodragend} no drag end after change of shape type
	\end{enumerate}
	\item Test realX and realY functions
	\begin{enumerate}[label={T\arabic{enumi}.\arabic*}]
		\item \label{test:js:func:realX} realX function
		\item \label{test:js:func:realY} realY function
	\end{enumerate}
	\setcounter{startvaluetest}{\value{enumi}}
\end{enumerate}

\subsection{Haskell}
Voor de Haskell-code zijn unit tests ontwikkeld. De code coverage van de tests is gemeten met \emph{HPC}—Haskell Program Coverage\cite{HPC}. Deze tool maakt onderdeel uit van Cabal.
Hieronder wordt een overzicht met testcases weergegeven van de Haskell-code. Alle test cases worden correct uitgevoerd.


\subsubsection{Testcases}

\input{./Hoofdstukken/resultaten/tests/haskell.tex}

\subsection{Blackbox testing}
Er zijn non-functionele requirements opgesteld in \autoref{hoofdstuk:requirements}. Deze requirements zijn lastig automatisch te testen. Daarom zijn hiervoor blackbox testen uitgevoerd zodat ook deze requirements getest zijn.

\subsubsection{Testcases}
\begin{enumerate}[label={T\arabic*}]
	\setcounter{enumi}{\value{startvaluetest}}
	\item Multiplatform, bij deze test wordt getest of de demoapplicatie werkt op ieder besturingssysteem.
    \begin{enumerate}[label={T\arabic{enumi}.\arabic*}]
    	\item de demoapplicatie kan gedraaid worden in Windows
    	\item de demoapplicatie kan gedraaid worden in Linux
    	\item de demoapplicatie kan gedraaid worden in OS X
    	\item de demoapplicatie kan gedraaid worden in OS X met retina display
    \end{enumerate}
	\item Browser onafhankelijk, bij deze test wordt getest of de demoapplicatie werkt in de laatste versies van iedere browser.
    \begin{enumerate}[label={T\arabic{enumi}.\arabic*}]
    	\item de demoapplicatie kan gedraaid worden in Chrome 32
    	\item de demoapplicatie kan gedraaid worden in Firefox 26
    	\item de demoapplicatie kan gedraaid worden in Internet Explorer 11
    	\item de demoapplicatie kan gedraaid worden in Safari 7
    \end{enumerate}
	\item Het controlleren van de code coverage voor de testen geschreven voor JavaScript en Haskell
\end{enumerate}

Met de code covarage libraries beschreven in \autoref{hoofdstuk:testplan} hebben we vast kunnen stellen dat onze testen de in JavaScript geschreven code voor 72 \% dekken. De JavaScript code die niet door een test wordt uitgevoerd heeft vooral toepassing op invoer zoals invoer middels toetsaanslagen, al dan niet met een modifier-key als ctrl.

\begin{figure}
\begin{center}
\includegraphics[keepaspectratio,width=\textwidth]{./images/haskellcoverage.png}
\caption{Code coverage resultaten uit HPC}
\label{fig:hpc}
\end{center}
\end{figure}

De code coverage resultaten die uit een analyse van HPC komen zijn niet direct uit te drukken in één compleet getal. Zoals te zien is in \autoref{fig:hpc}, zijn er verschillende onderdelen van de code die gemeten worden, namelijk: de definieties, alternatieven en expressies. Bij het evalueren van de resultaten kijken wij naar de expressies van de modules die relevant zijn voor het gegevensmodel. Zo zijn de test-modules zelf meegenomen in de resultaten, maar deze zijn deze resultaten niet relevant. Daarnaast zijn modules die te maken hebben met I/O en randzaken ook niet meegenomen in onze beoordeling aangezien het lastig is hiervoor betrouwbare tests te schrijven.

We kijken specifiek naar de \inlinecode{CanvasHs.Data}, \inlinecode{CanvasHs.Input}, \inlinecode{CanvasHs.Output}, \inlinecode{CanvasHs.ActionOutput} en \inlinecode{CanvasHs.ShapeOutput}. Hier komt het neer op 848 geteste expressies van de 1304. Dat is een resultaat van 65 \% code coverage voor de geschreven relevante Haskell-code.

\subsection{Traceability matrix} \label{sec:traceability}
De traceability matrix laat zien of alle requirements getests zijn. Wanneer een requirement niet getest is betekent dit dat de functie niet geimplementeerd is of dat er geen test voor bestaat. Met de traceability matrix kan bijgehouden worden of alle functionaliteit geimplementeerd is.

\begin{figure}
\begin{center}
\resizebox{\linewidth}{!}{\input{./Hoofdstukken/resultaten/tests/traceability_matrix.tex}}
\caption{Traceability matrix, zie \autoref{sec:traceability}}
\label{fig:traceability}
\end{center}
\end{figure}





